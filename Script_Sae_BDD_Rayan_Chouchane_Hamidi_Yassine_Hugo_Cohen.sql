/* -----------------------------------------------------------------------
BASE de DONNEES : Sae_BDD
Version : 1.0
Auteur : Rayan Chouchane, Hamidi Yassine, Hugo Cohen
Date cr√©ation : 24/03/2022
------------------------------------------------------------------------- */

drop schema if exists Sae_BDD cascade;
drop table if exists Criteres cascade ; 
drop table if exists Continents cascade ;
drop table if exists Pays cascade ;
drop table if exists CriterePays cascade ;
drop table if exists CritereContinent cascade ;

create schema Sae_BDD;
 
set search_path to Sae_BDD;


CREATE TABLE Criteres(
   Id_Critere INT PRIMARY KEY,
   Nom_Critere VARCHAR(50) NOT NULL
);

CREATE TABLE Continents(
   Iso_Continent VARCHAR(10) PRIMARY KEY,
   Nom_Continent VARCHAR(50) NOT NULL
);

CREATE TABLE Pays(
   Iso_Pays CHAR(3) PRIMARY KEY,
   Nom_Pays VARCHAR(50) NOT NULL,
   Nombre_Habitants DECIMAL(15,2) NOT NULL,
   Iso_Continent VARCHAR(10) REFERENCES Continents(Iso_Continent) NOT NULL
);

CREATE TABLE CriterePays(
   Iso_Pays CHAR(3) REFERENCES Pays(Iso_Pays) NOT NULL,
   Id_Critere INT REFERENCES Criteres(Id_Critere) NOT NULL,
   PRIMARY KEY(Iso_Pays, Id_Critere,Date_Valeur),
   Date_Valeur DATE NOT NULL,
   Valeur NUMERIC NOT NULL
);

CREATE TABLE CritereContinent(
   Iso_Continent VARCHAR(10) REFERENCES Continents(Iso_Continent) NOT NULL,
   Id_Critere INT REFERENCES Criteres(Id_Critere) NOT NULL,
   PRIMARY KEY(Iso_Continent, Id_Critere,Date_Valeur),
   Date_Valeur DATE NOT NULL,
   Valeur Numeric NOT NULL
);